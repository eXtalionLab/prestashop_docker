# the different stages of this Dockerfile are meant to be built into separate images
# https://docs.docker.com/develop/develop-images/multistage-build/#stop-at-a-specific-build-stage
# https://docs.docker.com/compose/compose-file/#target


# https://docs.docker.com/engine/reference/builder/#understand-how-arg-and-from-interact
ARG NGINX_VERSION=1.27


# "nginx" stage
FROM nginx:${NGINX_VERSION}-alpine

COPY --link --chmod=755 entrypoint.sh /usr/local/bin/entrypoint
COPY --link nginx.conf /etc/nginx/conf.d/default.conf.template

ENTRYPOINT ["entrypoint"]
CMD ["nginx", "-g", "daemon off;"]
